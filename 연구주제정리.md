# 연구 제안 보고서

**제목**: Complex-Blind Transformer(C-BiT): 원시 복소 데이터(SLC)와 물리 기반 손실 함수를 이용한 비대응 SAR 영상 초해상화

**연구자**: 임현서서

**예상 기간**: 미정정

**최종 수정**: 2025년 7월 13일

## 1. 연구 개요 (Executive Summary)

기존 합성개구레이더(SAR) 초해상화(Super-Resolution, SR) 연구는 위상 정보를 대부분 소실한 2차 산출물(GRD)을 사용하며, 스펙클(Speckle)을 제거 대상 노이즈로 간주하는 근본적 한계를 가집니다. 이는 간섭기법(InSAR), 표적 특성 분석 등 위상과 스펙클의 통계적 특성이 중요한 후속 분석으로의 연계를 단절시킵니다.

본 연구는 이러한 패러다임을 전환하여, 원본 복소 데이터(Single Look Complex, SLC)를 직접 입력받아 초해상화를 수행하는 새로운 프레임워크, C-BiT를 제안합니다. C-BiT는 복소수 연산이 가능한 Transformer 구조를 통해 진폭과 위상 정보를 동시에 처리하고, 물리 법칙에 기반한 손실 함수를 통해 고해상도 영상의 스펙클 통계 분포를 보존합니다. 

또한, CycleGAN 구조를 차용하여 완벽한 저해상도-고해상도(LR-HR) 영상 쌍 없이 비대응(unpaired) 데이터만으로 학습 가능하므로, 현실적인 데이터 수급 문제를 해결합니다. 최종적으로 본 연구는 단순한 시각적 개선을 넘어, 물리적으로 타당하고 후속 분석에 활용 가능한 고품질의 초해상화 SLC 데이터를 생성하는 것을 목표로 합니다.

## 2. 연구 배경 및 문제 정의

### SLC 데이터의 중요성
SAR 위성이 최초로 취득하는 SLC 데이터는 각 픽셀에 진폭(Amplitude)과 위상(Phase) 정보를 모두 포함하는 복소수 형태입니다. 위상 정보는 지표면의 높이(InSAR), 미세 변위, 표면 재질 등 고급 정보를 담고 있는 핵심 요소입니다.

### 기존 연구의 한계

**정보 손실**: 대부분의 딥러닝 SR 모델은 방사보정, 다중시기처리(Multi-looking) 과정에서 위상 정보가 대부분 소실되고 스펙클 특성이 변형된 GRD(Ground Range Detected) 데이터를 입력으로 사용합니다. 이는 '정보가 이미 손실된 데이터'를 복원하려는 본질적 한계를 가집니다.

**스펙클에 대한 오해**: 스펙클은 단순 노이즈가 아닌, 센서와 지표면의 상호작용을 반영하는 고유한 신호 특성입니다. 이론적으로 감마(Gamma) 분포를 따르는 이 특성을 무작정 제거하면 영상의 방사 정확도와 통계적 신뢰성이 저하됩니다.

**데이터 의존성**: 지도 학습(Supervised learning) 기반 모델은 동일 지역, 동일 시간에 촬영된 완벽한 LR-HR 영상 쌍을 요구하나, 이는 현실적으로 확보가 거의 불가능합니다.

## 3. 제안 방법론: C-BiT (Complex-Blind Transformer)

본 연구는 SLC 입력부터 최종 SR 결과물 출력까지의 파이프라인 전체를 설계합니다. 핵심은 (1) 전처리, (2) C-BiT 네트워크, (3) 후처리의 3단계로 구성됩니다. 특히 C-BiT는 비대응 학습을 위해 CycleGAN의 전체적인 구조 위에 구축됩니다.

### 3.1. 전체 아키텍처 (CycleGAN 기반)

C-BiT는 두 개의 생성자(Generator)와 두 개의 판별자(Discriminator)로 구성됩니다.

- **생성자 G_LR→HR**: 저해상도 SLC를 입력받아 초해상화된 SLC를 생성 (본 연구의 핵심 모델).
- **생성자 F_HR→LR**: 고해상도 SLC를 저해상도로 변환.
- **판별자 D_HR / D_LR**: 각각 생성된 HR/LR 영상이 실제 데이터인지 판별.

이러한 순환 구조는 LR → G(LR) → F(G(LR)) ≈ LR 이라는 Cycle-Consistency를 만족하게 함으로써, 쌍이 없는 데이터로도 도메인 간 변환을 안정적으로 학습시킵니다.

### 3.2. C-BiT 생성자 네트워크 (G_LR→HR) 상세 구조

생성자는 U-Net과 유사한 인코더-디코더 구조를 가지며, 핵심 연산 블록은 다음과 같습니다.

*[C-BiT 생성자 네트워크 구조 다이어그램]*

#### 입력 및 Complex Tokenizer
- **입력**: 전처리된 저해상도 SLC 영상 패치 (N × N × 1 크기의 복소수 행렬).
- **토큰화**: 이미지를 P × P 크기의 겹치지 않는 패치(토큰)로 분할. 각 토큰은 z = I_r + jI_i 형태의 복소수 벡터가 됩니다.

#### 인코더 (Encoder)

**C-QKV Self-Attention 블록**: 네트워크의 핵심.

기존 Transformer가 실수(Real-valued) 벡터에 대해 내적(Dot product)을 수행하는 것과 달리, C-BiT는 복소수 벡터에 대해 **복소 내적(Complex Inner Product)**을 수행합니다.

- Query(Q), Key(K), Value(V)는 모두 복소수 텐서입니다.
- **어텐션 스코어 계산**: Attention(Q, K, V) = softmax(Re(Q @ Kᴴ) / √d_k) @ V
- Kᴴ는 K의 **켤레 전치(Hermitian Transpose)**로, 위상 관계를 학습하는 데 결정적 역할을 합니다. 
- Re()는 복소 내적 결과의 실수부를 취해 softmax 입력으로 사용합니다.

이를 통해 모델은 픽셀 간의 진폭 유사성뿐만 아니라 위상 상관관계까지 동시에 학습할 수 있습니다.

**Complex LayerNorm & GeLU**: 복소수 데이터에 맞게 확장된 정규화 및 활성화 함수를 사용하여 학습 안정성을 확보합니다.

#### 디코더 (Decoder)

인코더의 출력과 스킵 연결(Skip Connection)을 통해 전달된 저수준 특징(Low-level features)을 결합합니다. 일련의 C-QKV 블록과 Upsampling 레이어를 거쳐 점진적으로 해상도를 복원합니다. 최종 출력은 입력과 동일한 차원의 초해상화된 SLC 복소 영상입니다.

### 3.3. 물리 기반 복합 손실 함수 (Hybrid Loss Function)

모델 학습에는 다음 세 가지 손실 함수를 가중합하여 사용합니다:

**L_total = λ_adv * L_adv + λ_cyc * L_cyc + λ_kld * L_kld**

#### Adversarial Loss (L_adv)
생성된 SR 영상이 판별자를 속여 실제 HR 영상처럼 보이도록 유도합니다. 이는 전체적인 질감과 사실성을 높이는 역할을 합니다.

**L_adv = E[log D_HR(HR)] + E[log(1 - D_HR(G(LR)))]**

#### Cycle-Consistency Loss (L_cyc)
비대응 학습의 핵심. 변환된 영상이 다시 원본 도메인으로 복원되었을 때, 원본 영상과의 차이를 최소화합니다. 이는 모델이 단순히 노이즈를 생성하는 것이 아니라, 구조적 특징을 보존하며 변환하도록 강제합니다.

**L_cyc = E[||F(G(LR)) - LR||₁] + E[||G(F(HR)) - HR||₁]**

#### Speckle KL-Divergence Loss (L_kld)
본 연구의 가장 중요한 제안 중 하나.

- **목표**: 생성된 SR 영상의 스펙클이 '제거'되는 것이 아니라, 목표 해상도에서 이론적으로 나타나야 할 **'올바른 통계적 분포'**를 갖도록 유도합니다.
- **원리**: L-look SAR 영상의 균일한 영역(homogeneous area)에서 스펙클의 진폭(또는 강도)은 **감마 분포 Γ(L, L)**를 따릅니다.
- **계산**: 생성된 SR 영상에서 균일한 패치를 샘플링하여 경험적 확률 밀도 함수(PDF)를 구하고, 이 분포가 목표하는 고해상도 영상의 이론적 감마 분포 Γ(L_target, L_target)와 얼마나 다른지를 쿨백-라이블러 발산(KL-Divergence)으로 측정합니다.

**L_kld = D_KL( PDF_speckle(G(LR)) || Γ(L_target, L_target) )**

이 손실 함수는 모델이 물리적으로 타당한, 즉 통계적으로 올바른 스펙클 특성을 가진 영상을 생성하도록 하는 강력한 규제(Regularization) 역할을 합니다.

### 3.4. 전처리 및 후처리

**전처리**: ESA의 SNAP 등 검증된 도구를 활용하여 SLC 데이터에 대한 정밀한 방사 보정(Radiometric Calibration to Sigma0) 및 스펙클 필터링(비교 실험용)을 수행하는 파이프라인을 구축합니다.

**후처리**: 모델이 출력한 초해상화 SLC 결과물에 DEM(Digital Elevation Model)을 이용한 지형 보정(Geometric Correction)을 적용하여, 지도 좌표계에 맞는 최종 분석용 데이터(Analysis-Ready Data)를 생성합니다.

## 4. 기대 효과 및 결론

본 연구는 기존 SAR 초해상화의 한계를 근본적으로 해결하는 새로운 접근법을 제시합니다.

### 학술적 기여
최초로 원시 복소 데이터(SLC)를 직접 처리하는 Transformer 기반 비대응 초해상화 프레임워크를 제안합니다. 특히, 스펙클 통계 분포를 보존하는 물리 기반 손실 함수는 SAR 영상 처리 분야에 새로운 방향을 제시할 것입니다.

### 실용적 가치
고가의 고해상도 SAR 영상 없이도 저해상도 공개 데이터(e.g., Sentinel-1)로부터 고품질의 분석용 데이터를 생성할 수 있습니다. 이는 재난 감시, 군사 정찰, 기반 시설 모니터링 등 다양한 분야에서 시공간적 제약을 극복하고 신속한 분석을 가능하게 할 것입니다.

결론적으로, C-BiT는 단순한 '보기 좋은 이미지'를 넘어 '물리적으로 의미 있고, 정량적 분석이 가능한' 초해상화 SAR 데이터를 생성함으로써, 위성 원격탐사 기술의 활용 범위를 한 단계 확장시킬 잠재력을 가집니다.

---
